{"version":3,"sources":["../../src/DBSetup.ts"],"sourcesContent":["import { ResultSetHeader } from \"mysql2\";\r\nimport { PoolConnection } from \"mysql2/promise\";\r\nexport const setupDatabase =async (conn:PoolConnection)=>{\r\n    try {\r\n        await conn.query<ResultSetHeader>('CREATE DATABASE IF NOT EXISTS UserDB;');\r\n        conn.changeUser({ database: 'UserDB' }).catch(err => {\r\n            if (err) throw err;\r\n        });\r\n    }\r\n    catch (e) {\r\n        throw { \"error\": \"Couldn't Connect Create The inital Database\" }\r\n    }\r\n\r\n    try {\r\n        await conn.query<ResultSetHeader>('DROP TABLE IF EXISTS user_table;');\r\n        await conn.query<ResultSetHeader>(\r\n            `CREATE TABLE  user_table (id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n            username VARCHAR(100) NOT NULL,\r\n            email VARCHAR(100) NOT NULL,\r\n            password VARCHAR(255)\r\n          );`\r\n        );\r\n    }\r\n    catch(err) {\r\n        console.error(err)\r\n        throw { \"error\": \"Couldn't Connect Create user_table\" }\r\n    }\r\n    try {\r\n        await conn.query<ResultSetHeader>('DROP TABLE IF EXISTS text_table;');\r\n        await conn.query<ResultSetHeader>(\r\n            `CREATE TABLE text_table (\r\n            id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n            tags VARCHAR(255),\r\n            title VARCHAR(255) NOT NULL,\r\n            body TEXT NOT NULL,\r\n            user_id INT,\r\n            FOREIGN KEY (user_id) REFERENCES users(id)\r\n          );`\r\n        );\r\n    }\r\n    catch {\r\n        throw { \"error\": \"Couldn't Connect Create text_table\" }\r\n    }\r\n}"],"names":["setupDatabase","conn","query","changeUser","database","catch","err","e","console","error"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAEA,OAAO,MAAMA,gBAAe,OAAOC;IAC/B,IAAI;QACA,MAAMA,KAAKC,KAAK,CAAkB;QAClCD,KAAKE,UAAU,CAAC;YAAEC,UAAU;QAAS,GAAGC,KAAK,CAACC,CAAAA;YAC1C,IAAIA,KAAK,MAAMA;QACnB;IACJ,EACA,OAAOC,GAAG;QACN,MAAM;YAAE,SAAS;QAA8C;IACnE;IAEA,IAAI;QACA,MAAMN,KAAKC,KAAK,CAAkB;QAClC,MAAMD,KAAKC,KAAK,CACZ,CAAC;;;;YAID,CAAC;IAET,EACA,OAAMI,KAAK;QACPE,QAAQC,KAAK,CAACH;QACd,MAAM;YAAE,SAAS;QAAqC;IAC1D;IACA,IAAI;QACA,MAAML,KAAKC,KAAK,CAAkB;QAClC,MAAMD,KAAKC,KAAK,CACZ,CAAC;;;;;;;YAOD,CAAC;IAET,EACA,OAAM;QACF,MAAM;YAAE,SAAS;QAAqC;IAC1D;AACJ,EAAC"}